var F=(o,t,i)=>{if(!t.has(o))throw TypeError("Cannot "+i)};var s=(o,t,i)=>(F(o,t,"read from private field"),i?i.call(o):t.get(o)),a=(o,t,i)=>{if(t.has(o))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(o):t.set(o,i)},d=(o,t,i,e)=>(F(o,t,"write to private field"),e?e.call(o,i):t.set(o,i),i);var r=(o,t,i)=>(F(o,t,"access private method"),i);import"./assets/styles-2330ef24.js";import{a as x}from"./assets/vendor-60fbd1ed.js";import{a as O,c as M}from"./assets/create-msg-2c2204d9.js";const X="https://65ac1573fcd1c9dcffc79214.mockapi.io/";function _(o){return o.reduce((t,{id:i,title:e,titleimage:l,author:b,price:n,pointer:p})=>t+`
      <li class="book" data-id="${i}">
            <img
              src="${l}"
              alt="book "
              width="400"
            />
            <p class="book-title">${e}</p>
            <p class="book-author">${b}</p>
            <p class="book-price">${n}</p>
            <div class="pointer-block">
              <input type="number" placeholder="${p}" />
              <button class="save" type="submit" data-id="${i}">Save</button>
            </div>
            <button class="delete" data-id="${i}">X</button>
          </li>
      `,"")}const z=(o,t)=>{const i=_(o);t.innerHTML="",t.insertAdjacentHTML("beforeend",i)};var c;class G{constructor(t){a(this,c,[]);d(this,c,t||[])}get books(){return s(this,c)}set books(t){d(this,c,t)}getBookById(t){return s(this,c).find(i=>i.id===t)}setBookById(t,i){d(this,c,s(this,c).map(e=>e.id===t?i:e))}addBook(t){s(this,c).push(t)}removeBook(t){d(this,c,s(this,c).filter(i=>i.id!==t))}updateBook(t){d(this,c,s(this,c).map(i=>i.id===t.id?t:i))}}c=new WeakMap;var h,m,B,f,C,A,u,L,k,v,j,S,q,$,H,I,R,y,g,D,K,w,T,E,U;class J{constructor({addFrmSelector:t,updateBtnClass:i,deleteBtnClass:e,bookSelector:l,libContainerSelector:b,renderingFn:n,dbURL:p}){a(this,v);a(this,S);a(this,$);a(this,I);a(this,y);a(this,D);a(this,w);a(this,E);a(this,h,void 0);a(this,m,void 0);a(this,B,void 0);a(this,f,void 0);a(this,C,void 0);a(this,A,void 0);a(this,u,void 0);a(this,L,void 0);a(this,k,void 0);d(this,h,new G),d(this,k,x.create({baseURL:p,headers:{"Content-Type":"application/json"}})),d(this,B,i),d(this,f,e),d(this,C,l),d(this,m,document.querySelector(t)),d(this,u,document.querySelector(b)),d(this,L,n),r(this,v,j).call(this)}destroy(){r(this,I,R).call(this)}onLibraryContainerClick(t){const i=t.target;r(this,w,T).call(this,i),r(this,E,U).call(this,i)}async onAddFrmSubmit(t){t.preventDefault();const i=new FormData(t.currentTarget),e={};i.forEach((b,n)=>e[n]=b),console.log(e);const l=await s(this,k).post("book",e);l.data&&(s(this,h).addBook(l.data),r(this,y,g).call(this),M("It's ok!"))}}h=new WeakMap,m=new WeakMap,B=new WeakMap,f=new WeakMap,C=new WeakMap,A=new WeakMap,u=new WeakMap,L=new WeakMap,k=new WeakMap,v=new WeakSet,j=function(){r(this,S,q).call(this),r(this,$,H).call(this)},S=new WeakSet,q=async function(){const t=await s(this,k).get("book");t!=null&&t.data&&(s(this,h).books=t==null?void 0:t.data,r(this,y,g).call(this))},$=new WeakSet,H=function(){s(this,u).addEventListener("click",this.onLibraryContainerClick.bind(this)),s(this,m).addEventListener("submit",this.onAddFrmSubmit.bind(this))},I=new WeakSet,R=function(){s(this,u).removeEventListener("click",this.onLibraryContainerClick.bind(this)),s(this,m).removeEventListener("submit",this.onAddFrmSubmit.bind(this))},y=new WeakSet,g=function(){s(this,L).call(this,s(this,h).books,s(this,u))},D=new WeakSet,K=function(t){console.log(t==null?void 0:t.message),O(t==null?void 0:t.message)},w=new WeakSet,T=async function(t){var e;if(!t.classList.contains(s(this,f)))return;const i=await s(this,k).delete(`book/${t.dataset.id}`);i!=null&&i.data&&(s(this,h).removeBook((e=i==null?void 0:i.data)==null?void 0:e.id),r(this,y,g).call(this),M("It's ok!"))},E=new WeakSet,U=async function(t){var p;if(!t.classList.contains(s(this,B)))return;const i=t.dataset.id,e=s(this,h).getBookById(i),l=document.querySelector(s(this,C)+`[data-id="${i}"]`).querySelector("input"),b={...e,pointer:l.value},n=await s(this,k).put(`book/${b.id}`,b);n!=null&&n.data&&(s(this,h).setBookById((p=n==null?void 0:n.data)==null?void 0:p.id,n==null?void 0:n.data),M("It's ok!"))};new J({addFrmSelector:".js-create-book-form",updateBtnClass:"save",deleteBtnClass:"delete",bookSelector:".book",libContainerSelector:".books-list",renderingFn:z,dbURL:X});
//# sourceMappingURL=commonHelpers3.js.map
