{"version":3,"file":"commonHelpers3.js","sources":["../src/js/api/constants.js","../src/js/library-page/book-cards-markup.js","../src/js/library-page/library-gallery-create.js","../src/js/library-page/library.js","../src/js/library-page/library-interface-axios.js","../src/js/library-page/library-handle.js"],"sourcesContent":["export const BASE_URL = 'https://65ac1573fcd1c9dcffc79214.mockapi.io/';\n","function bookCardsMarkup(books) {\n  return books.reduce(\n    (strMarkup, { id, title, titleimage, author, price, pointer }) =>\n      strMarkup +\n      `\n      <li class=\"book\" data-id=\"${id}\">\n            <img\n              src=\"${titleimage}\"\n              alt=\"book \"\n              width=\"400\"\n            />\n            <p class=\"book-title\">${title}</p>\n            <p class=\"book-author\">${author}</p>\n            <p class=\"book-price\">${price}</p>\n            <div class=\"pointer-block\">\n              <input type=\"number\" placeholder=\"${pointer}\" />\n              <button class=\"save\" type=\"submit\" data-id=\"${id}\">Save</button>\n            </div>\n            <button class=\"delete\" data-id=\"${id}\">X</button>\n          </li>\n      `,\n    ''\n  );\n}\n\nexport default bookCardsMarkup;\n","import bookCardsMarkup from './book-cards-markup';\n\nconst booksGalleryCreate = (books, booksGalleryContainer) => {\n  const strMarkup = bookCardsMarkup(books, booksGalleryContainer);\n  booksGalleryContainer.innerHTML = '';\n  booksGalleryContainer.insertAdjacentHTML('beforeend', strMarkup);\n};\n\nexport default booksGalleryCreate;\n","class Library {\n  #books = [];\n\n  constructor(books) {\n    this.#books = books || [];\n  }\n\n  get books() {\n    return this.#books;\n  }\n\n  set books(newBooks) {\n    this.#books = newBooks;\n  }\n\n  getBookById(id) {\n    return this.#books.find(book => book.id === id);\n  }\n\n  setBookById(id, newBook) {\n    this.#books = this.#books.map(book => (book.id === id ? newBook : book));\n  }\n\n  addBook(newBook) {\n    this.#books.push(newBook);\n  }\n\n  removeBook(idBook) {\n    this.#books = this.#books.filter(book => book.id !== idBook);\n  }\n\n  updateBook(updatedBook) {\n    this.#books = this.#books.map(book =>\n      book.id === updatedBook.id ? updatedBook : book\n    );\n  }\n}\n\nexport default Library;\n","import Library from './library.js';\nimport axios from 'axios';\nimport { createOkMsg, createErrMsg } from '../common/create-msg.js';\n\nclass LibraryInterface {\n  #libraryObj;\n  #addFrm;\n  #updateBtnClass;\n  #deleteBtnClass;\n  #bookSelector;\n  #booksCounter;\n  #libraryContainer;\n  #renderingFn;\n  #axiosInst;\n  constructor({\n    addFrmSelector,\n    updateBtnClass,\n    deleteBtnClass,\n    bookSelector,\n    libContainerSelector,\n    renderingFn,\n    dbURL,\n  }) {\n    this.#libraryObj = new Library();\n    this.#axiosInst = axios.create({\n      baseURL: dbURL,\n      headers: { 'Content-Type': 'application/json' },\n    });\n\n    this.#updateBtnClass = updateBtnClass;\n    this.#deleteBtnClass = deleteBtnClass;\n    this.#bookSelector = bookSelector;\n\n    this.#addFrm = document.querySelector(addFrmSelector);\n    this.#libraryContainer = document.querySelector(libContainerSelector);\n\n    this.#renderingFn = renderingFn;\n\n    this.#init();\n  }\n\n  destroy() {\n    this.#removeHandles();\n  }\n\n  #init() {\n    this.#initData();\n    this.#initHandles();\n  }\n\n  async #initData() {\n    const res = await this.#axiosInst.get('book');\n    if (res?.data) {\n      this.#libraryObj.books = res?.data;\n      this.#updateLibraryContainer();\n    }\n  }\n\n  #initHandles() {\n    this.#libraryContainer.addEventListener(\n      'click',\n      this.onLibraryContainerClick.bind(this)\n    );\n    this.#addFrm.addEventListener('submit', this.onAddFrmSubmit.bind(this));\n  }\n\n  #removeHandles() {\n    this.#libraryContainer.removeEventListener(\n      'click',\n      this.onLibraryContainerClick.bind(this)\n    );\n    this.#addFrm.removeEventListener('submit', this.onAddFrmSubmit.bind(this));\n  }\n\n  #updateLibraryContainer() {\n    this.#renderingFn(this.#libraryObj.books, this.#libraryContainer);\n  }\n\n  #onError(error) {\n    console.log(error?.message);\n    createErrMsg(error?.message);\n  }\n\n  onLibraryContainerClick(event) {\n    const element = event.target;\n    this.#onDeleteBtnClick(element);\n    this.#onUpdateBtnClick(element);\n  }\n\n  async #onDeleteBtnClick(element) {\n    if (!element.classList.contains(this.#deleteBtnClass)) return;\n    const res = await this.#axiosInst.delete(`book/${element.dataset.id}`);\n    if (res?.data) {\n      this.#libraryObj.removeBook(res?.data?.id);\n      this.#updateLibraryContainer();\n      createOkMsg(\"It's ok!\");\n    }\n  }\n\n  async #onUpdateBtnClick(element) {\n    if (!element.classList.contains(this.#updateBtnClass)) return;\n    const bookId = element.dataset.id;\n    const editedBook = this.#libraryObj.getBookById(bookId);\n    const inputRef = document\n      .querySelector(this.#bookSelector + `[data-id=\"${bookId}\"]`)\n      .querySelector('input');\n    const updateBook = {\n      ...editedBook,\n      pointer: inputRef.value,\n    };\n\n    const res = await this.#axiosInst.put(`book/${updateBook.id}`, updateBook);\n    if (res?.data) {\n      this.#libraryObj.setBookById(res?.data?.id, res?.data);\n      createOkMsg(\"It's ok!\");\n    }\n  }\n\n  async onAddFrmSubmit(event) {\n    event.preventDefault();\n    const formData = new FormData(event.currentTarget);\n    const newBook = {};\n    formData.forEach((value, key) => (newBook[key] = value));\n    console.log(newBook);\n\n    const res = await this.#axiosInst.post('book', newBook);\n    if (res.data) {\n      this.#libraryObj.addBook(res.data);\n      this.#updateLibraryContainer();\n      createOkMsg(\"It's ok!\");\n    }\n  }\n}\n\nexport default LibraryInterface;\n","import objectGetRequest from '../api/object-get-request';\nimport objectCreateRequest from '../api/object-create-request';\nimport objectUpdateRequest from '../api/object-update-request';\nimport objectDeleteRequest from '../api/object-delete-request';\nimport { createOkMsg, createErrMsg } from '../common/create-msg';\nimport booksGalleryCreate from './library-gallery-create';\n// import LibraryInterface from './library-interface-async';\nimport LibraryInterface from './library-interface-axios';\nimport { BASE_URL } from '../api/constants';\n\nconst libInterface = new LibraryInterface({\n  addFrmSelector: '.js-create-book-form',\n  updateBtnClass: 'save',\n  deleteBtnClass: 'delete',\n  bookSelector: `.book`,\n  libContainerSelector: '.books-list',\n  renderingFn: booksGalleryCreate,\n  dbURL: BASE_URL,\n});\n\n// let allBooks = [];\n\n// objectGetRequest('book')\n//   .then(books => {\n//     onSuccess(books);\n//   })\n//   .catch(error => {\n//     onError(error);\n//   });\n\n// const libraryRef = document.querySelector('.books-list');\n// libraryRef.addEventListener('click', onLibraryClick);\n\n// const createBookForm = document.querySelector('.js-create-book-form');\n// createBookForm.addEventListener('submit', onCreateBookFormSubmit);\n\n// function onSuccess(books) {\n//   console.log(books);\n//   allBooks = books;\n//   booksGalleryCreate(books, libraryRef);\n//   createOkMsg(\"It's ok!\");\n// }\n\n// function onError(error) {\n//   console.error(error.message);\n//   createErrMsg(error.message);\n// }\n\n// function onLibraryClick(event) {\n//   const element = event.target;\n//   onCloseBtnClick(element);\n//   onSaveBtnClick(element);\n// }\n\n// function onCloseBtnClick(element) {\n//   if (!element.classList.contains('delete')) return;\n//   objectDeleteRequest('book', element.dataset.id)\n//     .then(({ id }) => {\n//       if (id) {\n//         allBooks = allBooks.filter(book => book.id !== id);\n//         document.querySelector(`.book[data-id=\"${id}\"]`).remove();\n//       }\n//     })\n//     .catch(error => {\n//       onError(error);\n//     });\n// }\n\n// function onSaveBtnClick(element) {\n//   if (!element.classList.contains('save')) return;\n//   const bookId = element.dataset.id;\n//   const book = allBooks.find(book => book.id === bookId);\n//   const inputRef = document\n//     .querySelector(`.book[data-id=\"${bookId}\"]`)\n//     .querySelector('input');\n\n//   const updateBook = {\n//     ...book,\n//     pointer: inputRef.value,\n//   };\n\n//   allBooks = allBooks.map(book => (book.id === bookId ? updateBook : book));\n\n//   objectUpdateRequest('book', updateBook)\n//     .then(({ id }) => {\n//       if (id) {\n//         createOkMsg(\"It's ok!\");\n//       }\n//     })\n//     .catch(error => {\n//       onError(error);\n//     });\n// }\n\n// function onCreateBookFormSubmit(event) {\n//   event.preventDefault();\n//   const formData = new FormData(event.currentTarget);\n//   const newBook = {};\n//   formData.forEach((value, key) => (newBook[key] = value));\n//   console.log(newBook);\n//   objectCreateRequest('book', newBook)\n//     .then(book => {\n//       allBooks.push(book);\n//       booksGalleryCreate(allBooks, libraryRef);\n//     })\n//     .catch(error => {\n//       onError(error);\n//     });\n// }\n"],"names":["BASE_URL","bookCardsMarkup","books","strMarkup","id","title","titleimage","author","price","pointer","booksGalleryCreate","booksGalleryContainer","Library","__privateAdd","_books","__privateSet","__privateGet","newBooks","book","newBook","idBook","updatedBook","LibraryInterface","addFrmSelector","updateBtnClass","deleteBtnClass","bookSelector","libContainerSelector","renderingFn","dbURL","_init","_initData","_initHandles","_removeHandles","_updateLibraryContainer","_onError","_onDeleteBtnClick","_onUpdateBtnClick","_libraryObj","_addFrm","_updateBtnClass","_deleteBtnClass","_bookSelector","_booksCounter","_libraryContainer","_renderingFn","_axiosInst","axios","__privateMethod","init_fn","removeHandles_fn","event","element","onDeleteBtnClick_fn","onUpdateBtnClick_fn","formData","value","key","res","updateLibraryContainer_fn","createOkMsg","initData_fn","initHandles_fn","onError_fn","error","createErrMsg","_a","bookId","editedBook","inputRef","updateBook"],"mappings":"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"}