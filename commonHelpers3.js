var T=(i,t,e)=>{if(!t.has(i))throw TypeError("Cannot "+e)};var s=(i,t,e)=>(T(i,t,"read from private field"),e?e.call(i):t.get(i)),o=(i,t,e)=>{if(t.has(i))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(i):t.set(i,e)},r=(i,t,e,n)=>(T(i,t,"write to private field"),n?n.call(i,e):t.set(i,e),e);var a=(i,t,e)=>(T(i,t,"access private method"),e);import"./assets/styles-2330ef24.js";import"./assets/vendor-32231325.js";import{a as P,c as A}from"./assets/create-msg-41c53447.js";const X="https://65ac1573fcd1c9dcffc79214.mockapi.io/";function _(i){return i.reduce((t,{id:e,title:n,titleimage:d,author:u,price:b,pointer:F})=>t+`
      <li class="book" data-id="${e}">
            <img
              src="${d}"
              alt="book "
              width="400"
            />
            <p class="book-title">${n}</p>
            <p class="book-author">${u}</p>
            <p class="book-price">${b}</p>
            <div class="pointer-block">
              <input type="number" placeholder="${F}" />
              <button class="save" type="submit" data-id="${e}">Save</button>
            </div>
            <button class="delete" data-id="${e}">X</button>
          </li>
      `,"")}const x=(i,t)=>{const e=_(i);t.innerHTML="",t.insertAdjacentHTML("beforeend",e)};var c;class z{constructor(t){o(this,c,[]);r(this,c,t||[])}get books(){return s(this,c)}set books(t){r(this,c,t)}getBookById(t){return s(this,c).find(e=>e.id===t)}setBookById(t,e){r(this,c,s(this,c).map(n=>n.id===t?e:n))}addBook(t){s(this,c).push(t)}removeBook(t){r(this,c,s(this,c).filter(e=>e.id!==t))}updateBook(t){r(this,c,s(this,c).map(e=>e.id===t.id?t:e))}}c=new WeakMap;var L,k,B;class K{constructor(t){o(this,k);o(this,L,"");r(this,L,t)}objectGetRequest(t){return a(this,k,B).call(this,t)}objectCreateRequest(t,e){return a(this,k,B).call(this,t,{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}})}objectDeleteRequest(t,e){return a(this,k,B).call(this,`${t}/${e}`,{method:"DELETE"})}ojectUpdateRequest(t,e){return a(this,k,B).call(this,`${t}/${e.id}`,{method:"PUT",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}})}}L=new WeakMap,k=new WeakSet,B=function(t,e={}){return fetch(s(this,L)+t,e).then(n=>{if(!n.ok)throw new Error(n.status);return n.json()}).catch(n=>console.log(n.message))};var h,y,g,S,v,U,p,j,l,R,M,$,O,E,H,w,G,f,q,m,C,D,J,I,N;class Q{constructor({addFrmSelector:t,updateBtnClass:e,deleteBtnClass:n,bookSelector:d,libContainerSelector:u,renderingFn:b,dbURL:F}){o(this,R);o(this,$);o(this,E);o(this,w);o(this,f);o(this,m);o(this,D);o(this,I);o(this,h,void 0);o(this,y,void 0);o(this,g,void 0);o(this,S,void 0);o(this,v,void 0);o(this,U,void 0);o(this,p,void 0);o(this,j,void 0);o(this,l,void 0);r(this,h,new z),r(this,l,new K(F)),r(this,g,e),r(this,S,n),r(this,v,d),r(this,y,document.querySelector(t)),r(this,p,document.querySelector(u)),r(this,j,b),a(this,R,M).call(this)}destroy(){a(this,w,G).call(this)}onLibraryContainerClick(t){const e=t.target;a(this,D,J).call(this,e),a(this,I,N).call(this,e)}async onAddFrmSubmit(t){t.preventDefault();const e=new FormData(t.currentTarget),n={};e.forEach((d,u)=>n[u]=d);try{const d=await s(this,l).objectCreateRequest("book",n);d&&(s(this,h).addBook(d),a(this,f,q).call(this),A("It's ok!"))}catch(d){a(this,m,C).call(this,d)}}}h=new WeakMap,y=new WeakMap,g=new WeakMap,S=new WeakMap,v=new WeakMap,U=new WeakMap,p=new WeakMap,j=new WeakMap,l=new WeakMap,R=new WeakSet,M=function(){a(this,$,O).call(this),a(this,E,H).call(this)},$=new WeakSet,O=function(){s(this,l).objectGetRequest("book").then(t=>{s(this,h).books=t,a(this,f,q).call(this)}).catch(t=>a(this,m,C).call(this,t))},E=new WeakSet,H=function(){s(this,p).addEventListener("click",this.onLibraryContainerClick.bind(this)),s(this,y).addEventListener("submit",this.onAddFrmSubmit.bind(this))},w=new WeakSet,G=function(){s(this,p).removeEventListener("click",this.onLibraryContainerClick.bind(this)),s(this,y).removeEventListener("submit",this.onAddFrmSubmit.bind(this))},f=new WeakSet,q=function(){s(this,j).call(this,s(this,h).books,s(this,p))},m=new WeakSet,C=function(t){console.log(t==null?void 0:t.message),P(t==null?void 0:t.message)},D=new WeakSet,J=async function(t){if(t.classList.contains(s(this,S)))try{const e=await s(this,l).objectDeleteRequest("book",t.dataset.id);e&&(s(this,h).removeBook(e.id),a(this,f,q).call(this),A("It's ok!"))}catch(e){a(this,m,C).call(this,e)}},I=new WeakSet,N=async function(t){if(!t.classList.contains(s(this,g)))return;const e=t.dataset.id,n=s(this,h).getBookById(e),d=document.querySelector(s(this,v)+`[data-id="${e}"]`).querySelector("input"),u={...n,pointer:d.value};try{const b=await s(this,l).ojectUpdateRequest("book",u);b&&(s(this,h).setBookById(b.id,b),A("It's ok!"))}catch(b){a(this,m,C).call(this,b)}};new Q({addFrmSelector:".js-create-book-form",updateBtnClass:"save",deleteBtnClass:"delete",bookSelector:".book",libContainerSelector:".books-list",renderingFn:x,dbURL:X});
//# sourceMappingURL=commonHelpers3.js.map
