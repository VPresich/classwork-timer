{"version":3,"file":"commonHelpers3.js","sources":["../src/js/api/constants.js","../src/js/library-page/book-cards-markup.js","../src/js/library-page/library-gallery-create.js","../src/js/library-page/library.js","../src/js/api/db-api.js","../src/js/library-page/library-interface.js","../src/js/library-page/library-handle.js"],"sourcesContent":["export const BASE_URL = 'https://65ac1573fcd1c9dcffc79214.mockapi.io/';\n","function bookCardsMarkup(books) {\n  return books.reduce(\n    (strMarkup, { id, title, titleimage, author, price, pointer }) =>\n      strMarkup +\n      `\n      <li class=\"book\" data-id=\"${id}\">\n            <img\n              src=\"${titleimage}\"\n              alt=\"book \"\n              width=\"400\"\n            />\n            <p class=\"book-title\">${title}</p>\n            <p class=\"book-author\">${author}</p>\n            <p class=\"book-price\">${price}</p>\n            <div class=\"pointer-block\">\n              <input type=\"number\" placeholder=\"${pointer}\" />\n              <button class=\"save\" type=\"submit\" data-id=\"${id}\">Save</button>\n            </div>\n            <button class=\"delete\" data-id=\"${id}\">X</button>\n          </li>\n      `,\n    ''\n  );\n}\n\nexport default bookCardsMarkup;\n","import bookCardsMarkup from './book-cards-markup';\n\nconst booksGalleryCreate = (books, booksGalleryContainer) => {\n  const strMarkup = bookCardsMarkup(books, booksGalleryContainer);\n  booksGalleryContainer.innerHTML = '';\n  booksGalleryContainer.insertAdjacentHTML('beforeend', strMarkup);\n};\n\nexport default booksGalleryCreate;\n","class Library {\n  #books = [];\n\n  constructor(books) {\n    this.#books = books || [];\n  }\n\n  get books() {\n    return this.#books;\n  }\n\n  set books(newBooks) {\n    this.#books = newBooks;\n  }\n\n  getBookById(id) {\n    return this.#books.find(book => book.id === id);\n  }\n\n  setBookById(id, newBook) {\n    this.#books = this.#books.map(book => (book.id === id ? newBook : book));\n  }\n\n  addBook(newBook) {\n    this.#books.push(newBook);\n  }\n\n  removeBook(idBook) {\n    this.#books = this.#books.filter(book => book.id !== idBook);\n  }\n\n  updateBook(updatedBook) {\n    this.#books = this.#books.map(book =>\n      book.id === updatedBook.id ? updatedBook : book\n    );\n  }\n}\n\nexport default Library;\n","class DbApi {\n  #baseURL = '';\n\n  constructor(baseURL) {\n    this.#baseURL = baseURL;\n  }\n\n  #dbRequest(endPoint, attr = {}) {\n    return fetch(this.#baseURL + endPoint, attr)\n      .then(response => {\n        if (!response.ok) {\n          throw new Error(response.status);\n        }\n        return response.json();\n      })\n      .catch(error => console.log(error.message));\n  }\n\n  objectGetRequest(endPoint) {\n    return this.#dbRequest(endPoint);\n  }\n\n  objectCreateRequest(endPoint, obj) {\n    return this.#dbRequest(endPoint, {\n      method: 'POST',\n      body: JSON.stringify(obj),\n      headers: { 'Content-Type': 'application/json' },\n    });\n  }\n\n  objectDeleteRequest(endPoint, id) {\n    return this.#dbRequest(`${endPoint}/${id}`, {\n      method: 'DELETE',\n    });\n  }\n\n  ojectUpdateRequest(endPoint, obj) {\n    return this.#dbRequest(`${endPoint}/${obj.id}`, {\n      method: 'PUT',\n      body: JSON.stringify(obj),\n      headers: { 'Content-Type': 'application/json' },\n    });\n  }\n}\n\nexport default DbApi;\n","import Library from './library.js';\nimport DbApi from '../api/db-api.js';\nimport { createOkMsg, createErrMsg } from '../common/create-msg';\n\nclass LibraryInterface {\n  #libraryObj;\n  #addBtn;\n  #updateBtnClass;\n  #deleteBtnClass;\n  #bookSelector;\n  #booksCounter;\n  #libraryContainer;\n  #renderingFn;\n  #dbApi;\n  constructor({\n    addBtnSelector,\n    updateBtnClass,\n    deleteBtnClass,\n    bookSelector,\n    libContainerSelector,\n    renderingFn,\n    dbURL,\n  }) {\n    this.#libraryObj = new Library();\n    this.#dbApi = new DbApi(dbURL);\n\n    this.#updateBtnClass = updateBtnClass;\n    this.#deleteBtnClass = deleteBtnClass;\n    this.#bookSelector = bookSelector;\n    this.#addBtn = document.querySelector(addBtnSelector);\n    this.#libraryContainer = document.querySelector(libContainerSelector);\n    this.#renderingFn = renderingFn;\n    this.#init();\n  }\n\n  destroy() {\n    this.#removeHandles();\n  }\n\n  #init() {\n    this.#initData();\n    this.#initHandles();\n  }\n\n  #initData() {\n    this.#dbApi\n      .objectGetRequest('book')\n      .then(books => {\n        this.#libraryObj.books = books;\n        this.#updateLibraryContainer();\n      })\n      .catch(error => this.#onError(error));\n  }\n\n  #initHandles() {\n    this.#libraryContainer.addEventListener(\n      'click',\n      this.onLibraryContainerClick.bind(this)\n    );\n    this.#addBtn.addEventListener('click', this.onAddBtnClick.bind(this));\n  }\n\n  #removeHandles() {\n    this.#libraryContainer.removeEventListener(\n      'click',\n      this.onLibraryContainerClick.bind(this)\n    );\n    this.#addBtn.removeEventListener('click', this.onAddBtnClick.bind(this));\n  }\n\n  #updateLibraryContainer() {\n    this.#renderingFn(this.#libraryObj.books, this.#libraryContainer);\n  }\n\n  #onError(error) {\n    console.log(error);\n  }\n\n  onLibraryContainerClick(event) {\n    const element = event.target;\n    this.#onDeleteBtnClick(element);\n    this.#onUpdateBtnClick(element);\n  }\n\n  onAddBtnClick() {}\n\n  #onDeleteBtnClick(element) {\n    if (!element.classList.contains(this.#deleteBtnClass)) return;\n    this.#dbApi\n      .objectDeleteRequest('book', element.dataset.id)\n      .then(({ id }) => {\n        if (id) {\n          this.#libraryObj.removeBook(id);\n          this.#updateLibraryContainer();\n          createOkMsg(\"It's ok!\");\n        }\n      })\n      .catch(error => this.#onError(error));\n  }\n\n  #onUpdateBtnClick(element) {\n    if (!element.classList.contains(this.#updateBtnClass)) return;\n    const bookId = element.dataset.id;\n    const editedBook = this.#libraryObj.getBookById(bookId);\n    const inputRef = document\n      .querySelector(this.#bookSelector + `[data-id=\"${bookId}\"]`)\n      .querySelector('input');\n    const updateBook = {\n      ...editedBook,\n      pointer: inputRef.value,\n    };\n    this.#libraryObj.setBookById(bookId, updateBook);\n    this.#dbApi\n      .ojectUpdateRequest('book', updateBook)\n      .then(({ id }) => {\n        if (id) {\n          createOkMsg(\"It's ok!\");\n        }\n      })\n      .catch(error => this.#onError(error));\n  }\n}\n\nexport default LibraryInterface;\n","import objectGetRequest from '../api/object-get-request';\nimport objectCreateRequest from '../api/object-create-request';\nimport objectUpdateRequest from '../api/object-update-request';\nimport objectDeleteRequest from '../api/object-delete-request';\nimport { createOkMsg, createErrMsg } from '../common/create-msg';\nimport booksGalleryCreate from './library-gallery-create';\nimport LibraryInterface from './library-interface';\nimport { BASE_URL } from '../api/constants';\n\nconst libInterface = new LibraryInterface({\n  addBtnSelector: '.create',\n  updateBtnClass: 'save',\n  deleteBtnClass: 'delete',\n  bookSelector: `.book`,\n  libContainerSelector: '.books-list',\n  renderingFn: booksGalleryCreate,\n  dbURL: BASE_URL,\n});\n\n// let allBooks = [];\n\n// objectGetRequest('book')\n//   .then(books => {\n//     onSuccess(books);\n//   })\n//   .catch(error => {\n//     onError(error);\n//   });\n\n// const libraryRef = document.querySelector('.books-list');\n// libraryRef.addEventListener('click', onLibraryClick);\n\n// function onSuccess(books) {\n//   console.log(books);\n//   allBooks = books;\n//   booksGalleryCreate(books, libraryRef);\n//   createOkMsg(\"It's ok!\");\n// }\n\n// function onError(error) {\n//   console.error(error.message);\n//   createErrMsg(error.message);\n// }\n\n// function onLibraryClick(event) {\n//   const element = event.target;\n//   onCloseBtnClick(element);\n//   onSaveBtnClick(element);\n// }\n\n// function onCloseBtnClick(element) {\n//   if (!element.classList.contains('delete')) return;\n//   objectDeleteRequest('book', element.dataset.id)\n//     .then(({ id }) => {\n//       if (id) {\n//         allBooks = allBooks.filter(book => book.id !== id);\n//         document.querySelector(`.book[data-id=\"${id}\"]`).remove();\n//       }\n//     })\n//     .catch(error => {\n//       onError(error);\n//     });\n// }\n\n// function onSaveBtnClick(element) {\n//   if (!element.classList.contains('save')) return;\n//   const bookId = element.dataset.id;\n//   const book = allBooks.find(book => book.id === bookId);\n//   const inputRef = document\n//     .querySelector(`.book[data-id=\"${bookId}\"]`)\n//     .querySelector('input');\n\n//   const updateBook = {\n//     ...book,\n//     pointer: inputRef.value,\n//   };\n\n//   allBooks = allBooks.map(book => (book.id === bookId ? updateBook : book));\n\n//   objectUpdateRequest('book', updateBook)\n//     .then(({ id }) => {\n//       if (id) {\n//         createOkMsg(\"It's ok!\");\n//       }\n//     })\n//     .catch(error => {\n//       onError(error);\n//     });\n// }\n\n//////////////////////////////////////\n// objectCreateRequest('book', {\n//   title: 'My Book',\n//   price: 84,\n//   author: 'My Author',\n//   pointer: 12,\n//   img: 'https://cloudflare-ipfs.com/ipfs/Qmd3W5DuhgHirLHGVixi6V76LhCkZUz6pnFt5AJBiyvHye/avatar/1060.jpg',\n//   titleimage: 'https://loremflickr.com/640/480',\n// })\n//   .then(book => console.log(book))\n//   .catch(error => console.log(error.message));\n\n// objectGetRequest('book')\n//   .then(books => console.log(books))\n//   .catch(error => console.log(error));\n"],"names":["BASE_URL","bookCardsMarkup","books","strMarkup","id","title","titleimage","author","price","pointer","booksGalleryCreate","booksGalleryContainer","Library","__privateAdd","_books","__privateSet","__privateGet","newBooks","book","newBook","idBook","updatedBook","DbApi","baseURL","_dbRequest","_baseURL","endPoint","__privateMethod","dbRequest_fn","obj","attr","response","error","LibraryInterface","addBtnSelector","updateBtnClass","deleteBtnClass","bookSelector","libContainerSelector","renderingFn","dbURL","_init","_initData","_initHandles","_removeHandles","_updateLibraryContainer","_onError","_onDeleteBtnClick","_onUpdateBtnClick","_libraryObj","_addBtn","_updateBtnClass","_deleteBtnClass","_bookSelector","_booksCounter","_libraryContainer","_renderingFn","_dbApi","init_fn","removeHandles_fn","event","element","onDeleteBtnClick_fn","onUpdateBtnClick_fn","initData_fn","initHandles_fn","updateLibraryContainer_fn","onError_fn","createOkMsg","bookId","editedBook","inputRef","updateBook"],"mappings":"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"}