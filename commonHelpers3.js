var U=(i,t,e)=>{if(!t.has(i))throw TypeError("Cannot "+e)};var s=(i,t,e)=>(U(i,t,"read from private field"),e?e.call(i):t.get(i)),o=(i,t,e)=>{if(t.has(i))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(i):t.set(i,e)},a=(i,t,e,n)=>(U(i,t,"write to private field"),n?n.call(i,e):t.set(i,e),e);var r=(i,t,e)=>(U(i,t,"access private method"),e);import"./assets/styles-f4b6f4a8.js";import"./assets/vendor-32231325.js";import{c as M}from"./assets/create-msg-41c53447.js";const P="https://65ac1573fcd1c9dcffc79214.mockapi.io/";function X(i){return i.reduce((t,{id:e,title:n,titleimage:B,author:k,price:h,pointer:T})=>t+`
      <li class="book" data-id="${e}">
            <img
              src="${B}"
              alt="book "
              width="400"
            />
            <p class="book-title">${n}</p>
            <p class="book-author">${k}</p>
            <p class="book-price">${h}</p>
            <div class="pointer-block">
              <input type="number" placeholder="${T}" />
              <button class="save" type="submit" data-id="${e}">Save</button>
            </div>
            <button class="delete" data-id="${e}">X</button>
          </li>
      `,"")}const _=(i,t)=>{const e=X(i);t.innerHTML="",t.insertAdjacentHTML("beforeend",e)};var c;class x{constructor(t){o(this,c,[]);a(this,c,t||[])}get books(){return s(this,c)}set books(t){a(this,c,t)}getBookById(t){return s(this,c).find(e=>e.id===t)}setBookById(t,e){a(this,c,s(this,c).map(n=>n.id===t?e:n))}addBook(t){s(this,c).push(t)}removeBook(t){a(this,c,s(this,c).filter(e=>e.id!==t))}updateBook(t){a(this,c,s(this,c).map(e=>e.id===t.id?t:e))}}c=new WeakMap;var m,l,C;class z{constructor(t){o(this,l);o(this,m,"");a(this,m,t)}objectGetRequest(t){return r(this,l,C).call(this,t)}objectCreateRequest(t,e){return r(this,l,C).call(this,t,{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}})}objectDeleteRequest(t,e){return r(this,l,C).call(this,`${t}/${e}`,{method:"DELETE"})}ojectUpdateRequest(t,e){return r(this,l,C).call(this,`${t}/${e.id}`,{method:"PUT",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}})}}m=new WeakMap,l=new WeakSet,C=function(t,e={}){return fetch(s(this,m)+t,e).then(n=>{if(!n.ok)throw new Error(n.status);return n.json()}).catch(n=>console.log(n.message))};var d,p,f,L,v,D,b,g,u,q,O,R,H,j,F,E,G,S,w,y,$,I,J,A,N;class K{constructor({addBtnSelector:t,updateBtnClass:e,deleteBtnClass:n,bookSelector:B,libContainerSelector:k,renderingFn:h,dbURL:T}){o(this,q);o(this,R);o(this,j);o(this,E);o(this,S);o(this,y);o(this,I);o(this,A);o(this,d,void 0);o(this,p,void 0);o(this,f,void 0);o(this,L,void 0);o(this,v,void 0);o(this,D,void 0);o(this,b,void 0);o(this,g,void 0);o(this,u,void 0);a(this,d,new x),a(this,u,new z(T)),a(this,f,e),a(this,L,n),a(this,v,B),a(this,p,document.querySelector(t)),a(this,b,document.querySelector(k)),a(this,g,h),r(this,q,O).call(this)}destroy(){r(this,E,G).call(this)}onLibraryContainerClick(t){const e=t.target;r(this,I,J).call(this,e),r(this,A,N).call(this,e)}onAddBtnClick(){}}d=new WeakMap,p=new WeakMap,f=new WeakMap,L=new WeakMap,v=new WeakMap,D=new WeakMap,b=new WeakMap,g=new WeakMap,u=new WeakMap,q=new WeakSet,O=function(){r(this,R,H).call(this),r(this,j,F).call(this)},R=new WeakSet,H=function(){s(this,u).objectGetRequest("book").then(t=>{s(this,d).books=t,r(this,S,w).call(this)}).catch(t=>r(this,y,$).call(this,t))},j=new WeakSet,F=function(){s(this,b).addEventListener("click",this.onLibraryContainerClick.bind(this)),s(this,p).addEventListener("click",this.onAddBtnClick.bind(this))},E=new WeakSet,G=function(){s(this,b).removeEventListener("click",this.onLibraryContainerClick.bind(this)),s(this,p).removeEventListener("click",this.onAddBtnClick.bind(this))},S=new WeakSet,w=function(){s(this,g).call(this,s(this,d).books,s(this,b))},y=new WeakSet,$=function(t){console.log(t)},I=new WeakSet,J=function(t){t.classList.contains(s(this,L))&&s(this,u).objectDeleteRequest("book",t.dataset.id).then(({id:e})=>{e&&(s(this,d).removeBook(e),r(this,S,w).call(this),M("It's ok!"))}).catch(e=>r(this,y,$).call(this,e))},A=new WeakSet,N=function(t){if(!t.classList.contains(s(this,f)))return;const e=t.dataset.id,n=s(this,d).getBookById(e),B=document.querySelector(s(this,v)+`[data-id="${e}"]`).querySelector("input"),k={...n,pointer:B.value};s(this,d).setBookById(e,k),s(this,u).ojectUpdateRequest("book",k).then(({id:h})=>{h&&M("It's ok!")}).catch(h=>r(this,y,$).call(this,h))};new K({addBtnSelector:".create",updateBtnClass:"save",deleteBtnClass:"delete",bookSelector:".book",libContainerSelector:".books-list",renderingFn:_,dbURL:P});
//# sourceMappingURL=commonHelpers3.js.map
